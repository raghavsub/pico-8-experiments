pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
-- simple platfomer 
-- by bbs user mhughson

-- player
player = {}
player.x = 72
player.y = 16
player.dx = 0
player.dy = 0
player.on_ground=false
player.jumpvel = 3.4 -- tunable

grav = 0.2 -- tunable

function _update()

  local startx = player.x
  
  -- jump
  if (btnp(2) or btnp(4) or btnp(5)) and player.on_ground then
    player.dy = -player.jumpvel
  end
  
  -- walk 
  player.dx = 0
  if btn(0) then
    player.dx = -2
  end
  if btn(1) then
    player.dx = 2
  end
  
  -- move the player left/right
  player.x += player.dx
  
  -- check for walls
  local xoffset = 0
  if player.dx > 0 then 
    xoffset = 7
  end
  local h = mget((player.x + xoffset) / 8, (player.y + 7) / 8)
  if fget(h, 0) then
    -- they hit a wall so move them back to their original position
    -- it should really move them to the edge of the wall
    player.x = startx
  end
  
  -- accumulate gravity
  player.dy += grav
  
  -- fall
  player.y += player.dy
  
  -- hit floor
  local v = mget((player.x + 4) / 8, (player.y + 8) / 8)
  player.on_ground=false
  if player.dy >= 0 then
    -- look for a solid tile
    if fget(v, 0) then
      -- place player on top of tile
      player.y = flr(player.y / 8) * 8
      player.dy = 0
      player.on_ground=true
    end
  end
  
  -- hit ceiling
  v = mget((player.x + 4) / 8, player.y / 8)
  if player.dy <= 0 then
    -- look for a solid tile
    if fget(v, 0) then
      -- position player right below ceiling
      player.y = flr((player.y + 8) / 8) * 8
      player.dy = 0
    end
  end
end

function _draw()
  cls()
  map(0, 0, 0, 0, 128,128)
  spr(1, player.x, player.y)
end

__gfx__
0000000000cccc002244aa99bbbbbbbb010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000cc77cc02444a999bbbb3bbb101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000cc7ccccc2444a99933b33333010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000c7cccccc4442999a13333131101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000c7ccccccaa992244a1331214010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000cccccccca9992444a9112444101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000cccccc0a9992444a9992444010101010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000cccc00999a4442999a4442101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

__label__
00000000000000101011000000111000001110111011001000000000000000010011101110111011101010101001101010011001101100000000000000000000
00000000000000101001000000101000000010101001001000000000000000101011101010010001001010101010001010100010101010000000000000000000
00000000000000101001000000101000001110101001001110000011100000101010101110010001001110101010001110111010101010000000000000000000
00000000000000111001000000101000001000101001001010000000000000100010101010010001001010101010101010001010101010000000000000000000
00000000000000010011100100111000001110111011101110000000000000011010101010010001001010011011101010110011001010000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa99
2444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a999
2444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a999
4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a
aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244aa992244
a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444
a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444
999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442
2244aa9901010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012244aa99
2444a99910101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010102444a999
2444a99901010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012444a999
4442999a10101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010104442999a
aa9922440101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101aa992244
a99924441010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010a9992444
a99924440101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101a9992444
999a44421010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010999a4442
2244aa9901010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012244aa99
2444a99910101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010102444a999
2444a99901010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012444a999
4442999a10101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010104442999a
aa9922440101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101aa992244
a99924441010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010a9992444
a99924440101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101a9992444
999a44421010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010999a4442
2244aa9901010101bbbbbbbbbbbbbbbb01010101010101010101010101010101010101010101010101010101010101010101010101010101010101012244aa99
2444a99910101010bbbb3bbbbbbb3bbb10101010101010101010101010101010101010101010101010101010101010101010101010101010101010102444a999
2444a9990101010133b3333333b3333301010101010101010101010101010101010101010101010101010101010101010101010101010101010101012444a999
4442999a10101010133331311333313110101010101010101010101010101010101010101010101010101010101010101010101010101010101010104442999a
aa99224401010101a1331214a13312140101010101010101010101010101010101010101010101010101010101010101010101010101010101010101aa992244
a999244410101010a9112444a91124441010101010101010101010101010101010101010101010101010101010101010101010101010101010101010a9992444
a999244401010101a9992444a99924440101010101010101010101010101010101010101010101010101010101010101010101010101010101010101a9992444
999a444210101010999a4442999a44421010101010101010101010101010101010101010101010101010101010101010101010101010101010101010999a4442
2244aa99010101012244aa990101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012244aa99
2444a999101010102444a9991010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010102444a999
2444a999010101012444a9990101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012444a999
4442999a101010104442999a1010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010104442999a
aa99224401010101aa992244010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101aa992244
a999244410101010a9992444101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010a9992444
a999244401010101a9992444010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101a9992444
999a444210101010999a4442101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010999a4442
2244aa99010101012244aa990101010101010101bbbbbbbbbbbbbbbbbbbbbbbb010101010101010101010101010101010101010101010101010101012244aa99
2444a999101010102444a9991010101010101010bbbb3bbbbbbb3bbbbbbb3bbb101010101010101010101010101010101010101010101010101010102444a999
2444a999010101012444a999010101010101010133b3333333b3333333b33333010101010101010101010101010101010101010101010101010101012444a999
4442999a101010104442999a1010101010101010133331311333313113333131101010101010101010101010101010101010101010101010101010104442999a
aa99224401010101aa9922440101010101010101a1331214a1331214a133121401010101010101010101010101010101010101010101010101010101aa992244
a999244410101010a99924441010101010101010a9112444a9112444a911244410101010101010101010101010101010101010101010101010101010a9992444
a999244401010101a99924440101010101010101a9992444a9992444a999244401010101010101010101010101010101010101010101010101010101a9992444
999a444210101010999a44421010101010101010999a4442999a4442999a444210101010101010101010101010101010101010101010101010101010999a4442
2244aa99010101012244aa990101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012244aa99
2444a999101010102444a9991010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010102444a999
2444a999010101012444a9990101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012444a999
4442999a101010104442999a1010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010104442999a
aa99224401010101aa992244010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101aa992244
a999244410101010a9992444101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010a9992444
a999244401010101a9992444010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101a9992444
999a444210101010999a4442101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010999a4442
2244aa9901010101010101010101010101010101010101010101010101010101010101010101010101010101bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb2244aa99
2444a99910101010101010101010101010101010101010101010101010101010101010101010101010101010bbbb3bbbbbbb3bbbbbbb3bbbbbbb3bbb2444a999
2444a9990101010101010101010101010101010101010101010101010101010101010101010101010101010133b3333333b3333333b3333333b333332444a999
4442999a10101010101010101010101010101010101010101010101010101010101010101010101010101010133331311333313113333131133331314442999a
aa99224401010101010101010101010101010101010101010101010101010101010101010101010101010101a1331214a1331214a1331214a1331214aa992244
a999244410101010101010101010101010101010101010101010101010101010101010101010101010101010a9112444a9112444a9112444a9112444a9992444
a999244401010101010101010101010101010101010101010101010101010101010101010101010101010101a9992444a9992444a9992444a9992444a9992444
999a444210101010101010101010101010101010101010101010101010101010101010101010101010101010999a4442999a4442999a4442999a4442999a4442
2244aa99bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb0101010101010101010101010101010101010101bbbbbbbb2244aa992244aa992244aa992244aa992244aa99
2444a999bbbb3bbbbbbb3bbbbbbb3bbbbbbb3bbb1010101010101010101010101010101010101010bbbb3bbb2444a9992444a9992444a9992444a9992444a999
2444a99933b3333333b3333333b3333333b33333010101010101010101010101010101010101010133b333332444a9992444a9992444a9992444a9992444a999
4442999a133331311333313113333131133331311010101010101010101010101010101010101010133331314442999a4442999a4442999a4442999a4442999a
aa992244a1331214a1331214a1331214a13312140101010101010101010101010101010101010101a1331214aa992244aa992244aa992244aa992244aa992244
a9992444a9112444a9112444a9112444a91124441010101010101010101010101010101010101010a9112444a9992444a9992444a9992444a9992444a9992444
a9992444a9992444a9992444a9992444a99924440101010101010101010101010101010101010101a9992444a9992444a9992444a9992444a9992444a9992444
999a4442999a4442999a4442999a4442999a44421010101010101010101010101010101010101010999a4442999a4442999a4442999a4442999a4442999a4442
2244aa9901010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012244aa99
2444a99910101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010102444a999
2444a99901010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012444a999
4442999a10101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010104442999a
aa9922440101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101aa992244
a99924441010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010a9992444
a99924440101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101a9992444
999a44421010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010999a4442
2244aa9901010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012244aa99
2444a99910101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010102444a999
2444a99901010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101012444a999
4442999a10101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010104442999a
aa9922440101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101aa992244
a99924441010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010a9992444
a99924440101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101a9992444
999a44421010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010999a4442
2244aa9901010101bbbbbbbb010101010101010101cccc01010101010101010101010101bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb2244aa99
2444a99910101010bbbb3bbb10101010101010101cc77cc0101010101010101010101010bbbb3bbbbbbb3bbbbbbb3bbbbbbb3bbbbbbb3bbbbbbb3bbb2444a999
2444a9990101010133b333330101010101010101cc7ccccc01010101010101010101010133b3333333b3333333b3333333b3333333b3333333b333332444a999
4442999a10101010133331311010101010101010c7cccccc1010101010101010101010101333313113333131133331311333313113333131133331314442999a
aa99224401010101a13312140101010101010101c7cccccc010101010101010101010101a1331214a1331214a1331214a1331214a1331214a1331214aa992244
a999244410101010a91124441010101010101010cccccccc101010101010101010101010a9112444a9112444a9112444a9112444a9112444a9112444a9992444
a999244401010101a999244401010101010101010cccccc1010101010101010101010101a9992444a9992444a9992444a9992444a9992444a9992444a9992444
999a444210101010999a4442101010101010101010cccc10101010101010101010101010999a4442999a4442999a4442999a4442999a4442999a4442999a4442
2244aa99010101012244aa990101010101010101bbbbbbbb0101010101010101010101012244aa992244aa992244aa992244aa992244aa992244aa992244aa99
2444a999101010102444a9991010101010101010bbbb3bbb1010101010101010101010102444a9992444a9992444a9992444a9992444a9992444a9992444a999
2444a999010101012444a999010101010101010133b333330101010101010101010101012444a9992444a9992444a9992444a9992444a9992444a9992444a999
4442999a101010104442999a1010101010101010133331311010101010101010101010104442999a4442999a4442999a4442999a4442999a4442999a4442999a
aa99224401010101aa9922440101010101010101a1331214010101010101010101010101aa992244aa992244aa992244aa992244aa992244aa992244aa992244
a999244410101010a99924441010101010101010a9112444101010101010101010101010a9992444a9992444a9992444a9992444a9992444a9992444a9992444
a999244401010101a99924440101010101010101a9992444010101010101010101010101a9992444a9992444a9992444a9992444a9992444a9992444a9992444
999a444210101010999a44421010101010101010999a4442101010101010101010101010999a4442999a4442999a4442999a4442999a4442999a4442999a4442
2244aa99010101012244aa9901010101010101012244aa9901010101bbbbbbbb010101012244aa992244aa992244aa992244aa992244aa992244aa992244aa99
2444a999101010102444a99910101010101010102444a99910101010bbbb3bbb101010102444a9992444a9992444a9992444a9992444a9992444a9992444a999
2444a999010101012444a99901010101010101012444a9990101010133b33333010101012444a9992444a9992444a9992444a9992444a9992444a9992444a999
4442999a101010104442999a10101010101010104442999a1010101013333131101010104442999a4442999a4442999a4442999a4442999a4442999a4442999a
aa99224401010101aa9922440101010101010101aa99224401010101a133121401010101aa992244aa992244aa992244aa992244aa992244aa992244aa992244
a999244410101010a99924441010101010101010a999244410101010a911244410101010a9992444a9992444a9992444a9992444a9992444a9992444a9992444
a999244401010101a99924440101010101010101a999244401010101a999244401010101a9992444a9992444a9992444a9992444a9992444a9992444a9992444
999a444210101010999a44421010101010101010999a444210101010999a444210101010999a4442999a4442999a4442999a4442999a4442999a4442999a4442
2244aa99bbbbbbbb2244aa99bbbbbbbbbbbbbbbb2244aa99bbbbbbbb2244aa99bbbbbbbb2244aa992244aa992244aa992244aa992244aa992244aa992244aa99
2444a999bbbb3bbb2444a999bbbb3bbbbbbb3bbb2444a999bbbb3bbb2444a999bbbb3bbb2444a9992444a9992444a9992444a9992444a9992444a9992444a999
2444a99933b333332444a99933b3333333b333332444a99933b333332444a99933b333332444a9992444a9992444a9992444a9992444a9992444a9992444a999
4442999a133331314442999a13333131133331314442999a133331314442999a133331314442999a4442999a4442999a4442999a4442999a4442999a4442999a
aa992244a1331214aa992244a1331214a1331214aa992244a1331214aa992244a1331214aa992244aa992244aa992244aa992244aa992244aa992244aa992244
a9992444a9112444a9992444a9112444a9112444a9992444a9112444a9992444a9112444a9992444a9992444a9992444a9992444a9992444a9992444a9992444
a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444a9992444
999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442999a4442

__gff__
0000010100010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

__map__
0500050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204040404040404040404040404040200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204040404040404040404040404040200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204030304040404040404040404040200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204020404040404040404040404040200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204020404030303040404040404040200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204020404040404040404040404040200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204040404040404040404030303030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0203030303040404040403020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204040404040404040404040404040200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204040404040404040404040404040200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204030404040404040303030303030200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204020404030404040202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0204020404020403040202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0203020303020302030202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
